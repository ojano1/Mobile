---
done: false
---
### ✍️My Notes

[[Kuliah subuh]]
[[📌Task - dkfjfn]]
[[📌Task - dkdjdn]]
[[🚀Project - dkdjn]]
[[🎯Goal - djdjdn]]
___
### 📌My tasks for today
~~~dataviewjs
(async () => {
  // --- host date from filename: "11 Oct 2025" or "2025-10-11"
  const host = dv.current().file.name;
  const m = window.moment(host, ["D MMM YYYY", "DD MMM YYYY", "YYYY-MM-DD"], true);
  if (!m.isValid()) { dv.paragraph("Filename needs a date like 11 Oct 2025 or 2025-10-11."); return; }
  const ISO = m.format("YYYY-MM-DD");

  // --- candidates: only notes with "Task" in name, exclude Templates/Archive and names ending with "!"
  const pages = dv.pages().where(p =>
    !/Templates|Archive/i.test(p.file.folder) &&
    !/[!]\s*$/.test(p.file.name) &&
    p.file.name.includes("Task")
  );

  // --- helpers
  const prRank = { High: 1, Medium: 2, Med: 2, Low: 3 };
  const rx = s => String(s).replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
  function toNum(v){ const n = Number(v); return Number.isFinite(n) ? n : 1e9; }
  function toNumOrNull(v){ const n = Number(v); return Number.isFinite(n) ? n : null; }
  function sectionText(src, name) {
    const re = new RegExp(`^#{1,6}\\s+${rx(name)}\\s*$`, "gim");
    const m = re.exec(src); if (!m) return null;
    const start = m.index + m[0].length;
    const level = (m[0].match(/^#+/) || ["#"])[0].length;
    const next = new RegExp(`^#{1,${level}}\\s+`, "gim"); next.lastIndex = start;
    const n = next.exec(src);
    return { text: src.slice(start, n ? n.index : src.length) };
  }
  function firstCheckbox(sec) {
    const re = /^[ \t>]*[-*]\s+\[( |x|X)\]\s.*$/m;
    const m = re.exec(sec.text); if (!m) return null;
    return { checked: /\[(x|X)\]/.test(m[0]) };
  }

  // --- gather rows
  const rows = [];
  for (const p of pages) {
    // due must equal host date
    let dueISO = null;
    if (p.due) {
      const mdue = window.moment(String(p.due), ["YYYY-MM-DD", "D MMM YYYY", window.moment.ISO_8601], true);
      if (mdue.isValid()) dueISO = mdue.format("YYYY-MM-DD");
    }
    if (dueISO !== ISO) continue;

    // first checkbox under "My Task"
    const file = app.vault.getAbstractFileByPath(p.file.path);
    if (!file) continue;
    const text = await app.vault.read(file);
    const sec = sectionText(text, "My Task");
    if (!sec) continue;
    const box = firstCheckbox(sec);
    if (!box) continue;

    const checked = typeof p.done === "boolean" ? p.done : box.checked; // prefer YAML
    rows.push({
      path: p.file.path,
      name: p.file.name,
      checked,
      pri: p.priority ?? "",
      dur: p.duration_hours ?? ""
    });
  }

  if (!rows.length) { dv.paragraph("Nothing for today🪁"); return; }

  // --- sort: priority then shortest duration
  rows.sort((a, b) => {
    const ap = prRank[a.pri] ?? 9, bp = prRank[b.pri] ?? 9;
    const ad = toNum(a.dur), bd = toNum(b.dur);
    return ap - bp || ad - bd;
  });

  // --- render compact list with live checkboxes
  const list = document.createElement("ul");
  list.style.listStyle = "none";
  list.style.paddingLeft = "0";
  list.style.margin = "0";

  for (const r of rows) {
    const li = document.createElement("li");
    li.style.display = "flex";
    li.style.alignItems = "center";
    li.style.gap = "8px";
    li.style.padding = "2px 0";

    const cb = document.createElement("input");
    cb.type = "checkbox";
    cb.checked = r.checked;
    cb.addEventListener("change", async () => {
      const f = app.vault.getAbstractFileByPath(r.path);
      if (!f) return;
      await app.fileManager.processFrontMatter(f, fm => { fm.done = cb.checked; });
      link.classList.toggle("is-done", cb.checked);
    });

    const link = document.createElement("a");
    link.textContent = r.name;
    link.href = "#";
    link.onclick = e => { e.preventDefault(); app.workspace.openLinkText(r.path, dv.current().file.path, false); };
    if (r.checked) link.classList.add("is-done");

    const meta = document.createElement("span");
    meta.style.opacity = "0.8";
    meta.style.marginLeft = "6px";
    const hrs = toNumOrNull(r.dur);
    const time = hrs == null ? "" : `${hrs} hr${hrs === 1 ? "" : "s"}`;
    const bits = [r.pri || "", time].filter(Boolean);
    if (bits.length) meta.textContent = "· " + bits.join(" · ");

    li.append(cb, link, meta);
    list.appendChild(li);
  }

  const style = document.createElement("style");
  style.textContent = `.is-done{ text-decoration: line-through; }`;
  dv.container.append(style, list);
})();
~~~
### New Code
~~~dataviewjs
(async () => {
  // --- host date from filename: "11 Oct 2025" or "2025-10-11"
  const host = dv.current().file.name;
  const m = window.moment(host, ["D MMM YYYY", "DD MMM YYYY", "YYYY-MM-DD"], true);
  if (!m.isValid()) { dv.paragraph("Filename needs a date like 11 Oct 2025 or 2025-10-11."); return; }
  const ISO = m.format("YYYY-MM-DD");

  // --- candidates: Task notes only, exclude Templates/Archive and names ending with "!"
  const pages = dv.pages().where(p =>
    !/Templates|Archive/i.test(p.file.folder) &&
    !/[!]\s*$/.test(p.file.name) &&
    p.file.name.includes("Task")
  );

  // --- helpers
  const prRank = { High: 1, Medium: 2, Med: 2, Low: 3 };
  const rx = s => String(s).replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
  function toNum(v){ const n = Number(v); return Number.isFinite(n) ? n : 1e9; }
  function toNumOrNull(v){ const n = Number(v); return Number.isFinite(n) ? n : null; }
  function sectionText(src, name) {
    const re = new RegExp(`^#{1,6}\\s+${rx(name)}\\s*$`, "gim");
    const m = re.exec(src); if (!m) return null;
    const start = m.index + m[0].length;
    const level = (m[0].match(/^#+/) || ["#"])[0].length;
    const next = new RegExp(`^#{1,${level}}\\s+`, "gim"); next.lastIndex = start;
    const n = next.exec(src);
    return { text: src.slice(start, n ? n.index : src.length) };
  }
  function firstCheckbox(sec) {
    const re = /^[ \t>]*[-*]\s+\[( |x|X)\]\s.*$/m;
    const m = re.exec(sec.text); if (!m) return null;
    return { checked: /\[(x|X)\]/.test(m[0]) };
  }
  // small debounce to reduce re-render flicker on rapid toggles
  const debounce = (fn, ms=250) => {
    let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), ms); };
  };

  // --- gather rows
  const rows = [];
  for (const p of pages) {
    // due must equal host date
    let dueISO = null;
    if (p.due) {
      const mdue = window.moment(String(p.due), ["YYYY-MM-DD", "D MMM YYYY", window.moment.ISO_8601], true);
      if (mdue.isValid()) dueISO = mdue.format("YYYY-MM-DD");
    }
    if (dueISO !== ISO) continue;

    // first checkbox under "My Task"
    const file = app.vault.getAbstractFileByPath(p.file.path);
    if (!file) continue;
    const text = await app.vault.read(file);
    const sec = sectionText(text, "My Task");
    if (!sec) continue;
    const box = firstCheckbox(sec);
    if (!box) continue;

    const checked = typeof p.done === "boolean" ? p.done : box.checked; // prefer YAML
    rows.push({
      path: p.file.path,
      name: p.file.name,
      checked,
      pri: p.priority ?? "",
      dur: p.duration_hours ?? ""
    });
  }

  if (!rows.length) { dv.paragraph("Nothing for today🪁"); return; }

  // --- sort: priority then shortest duration
  rows.sort((a, b) => {
    const ap = prRank[a.pri] ?? 9, bp = prRank[b.pri] ?? 9;
    const ad = toNum(a.dur), bd = toNum(b.dur);
    return ap - bp || ad - bd;
  });

  // --- render with layout
  const list = document.createElement("ul");
  list.style.listStyle = "none";
  list.style.paddingLeft = "0";
  list.style.margin = "0";

  for (const r of rows) {
    const li = document.createElement("li");
    li.style.display = "flex";
    li.style.flexDirection = "column";
    li.style.gap = "2px";
    li.style.padding = "4px 0";

    // line 1: checkbox + link
    const row1 = document.createElement("div");
    row1.style.display = "flex";
    row1.style.alignItems = "center";
    row1.style.gap = "8px";

    const cb = document.createElement("input");
    cb.type = "checkbox";
    cb.checked = r.checked;

    const link = document.createElement("a");
    link.textContent = r.name;
    link.href = "#";
    link.onclick = e => { e.preventDefault(); app.workspace.openLinkText(r.path, dv.current().file.path, false); };

    const doneMark = document.createElement("span");
    doneMark.textContent = " ✅";
    doneMark.style.display = r.checked ? "inline" : "none";

    row1.append(cb, link, doneMark);

    // line 2: YAML meta (left aligned, no leading dot)
    const row2 = document.createElement("div");
    row2.style.opacity = "0.8";
    row2.style.marginLeft = "26px"; // align under link text
    const hrs = toNumOrNull(r.dur);
    const time = hrs == null ? "" : `${hrs} hr${hrs === 1 ? "" : "s"}`;
    const bits = [r.pri || "", time].filter(Boolean);
    row2.textContent = bits.join(" · ");

    const applyDoneStyle = done => {
      link.style.textDecoration = done ? "line-through" : "none";
      row2.style.display = done ? "none" : "block";
      doneMark.style.display = done ? "inline" : "none";
    };
    applyDoneStyle(r.checked);

    // checkbox sync to YAML, debounced write
    const saveFrontmatter = debounce(async (checked) => {
      const f = app.vault.getAbstractFileByPath(r.path);
      if (!f) return;
      await app.fileManager.processFrontMatter(f, fm => { fm.done = checked; });
    }, 200);

    cb.addEventListener("change", async () => {
      applyDoneStyle(cb.checked);   // optimistic UI
      saveFrontmatter(cb.checked);  // debounced YAML write
      renderAllDoneMsg();           // update footer message
    });

    li.append(row1, row2);
    list.appendChild(li);
  }

  // footer message, left-aligned like the checkboxes
  const msg = document.createElement("div");
  msg.style.marginTop = "8px";
  msg.style.textAlign = "left";    // align left
  msg.style.paddingLeft = "0";     // same left edge as checkboxes

  const renderAllDoneMsg = () => {
    const allDone = Array.from(list.querySelectorAll('input[type="checkbox"]')).every(x => x.checked);
    msg.textContent = allDone ? "All done, nice work! 🎉☕️" : "";
  };
  renderAllDoneMsg();

  dv.container.append(list, msg);
})();
~~~~
### My Habits for today:
```dataviewjs
const HABIT_FOLDER = "03 SaveBox/Active";

// Get date from current note's filename: DD MMM YYYY
const fileName = dv.current()?.file?.name ?? "";
const m = fileName.match(/(\d{1,2} [A-Za-z]{3} \d{4})/);

let fileDate = null;
if (m) fileDate = window.moment(m[1], "DD MMM YYYY").format("YYYY-MM-DD");

if (!fileDate) {
  dv.paragraph("No valid date found in filename.");
} else {
  const pages = dv.pages(`"${HABIT_FOLDER}"`)
    .where(p => p.file.name.includes("Habit -") || p.file.name.includes("🔁Habit -"));

  function pickTasksForDate(p) {
    const ts = p.file.tasks ?? [];
    const rx = new RegExp(`(?:\\s|\\^)${fileDate}\\s*$`);
    const dated = ts.filter(t => rx.test(t.text));
    if (!dated.length) return null;
    return dated.find(t => !t.completed) ?? dated[0];
  }

  const tasks = pages.array().map(pickTasksForDate).filter(Boolean);
  if (tasks.length) dv.taskList(tasks, false);
  else dv.paragraph(`No habit tasks for ${m[1]}.`);
}

```
[[🧠Mind Map]]
### Overdue Tasks

~~~dataviewjs
const ROOT = "03 SaveBox/Active";

// --- get "today" (host date) from the host filename ---
const hostName = dv.current().file.name;
// supports "07 Oct 2025" or "Tue, 07 Oct 2025"
const m = hostName.match(/(\d{1,2})\s*(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Sept|Oct|Nov|Dec|January|February|March|April|June|July|August|September|October|November|December)\s*(\d{4})/i);
if (!m) { dv.paragraph("❌ Host filename needs a date like `07 Oct 2025`."); return; }
const mm = {jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"}[m[2].toLowerCase().slice(0,3)];
const day = String(parseInt(m[1],10)).padStart(2,"0");
const todayISO = `${m[3]}-${mm}-${day}`;
const today = dv.date(todayISO);
// --- end host date ---

const pages = dv.pages(`"${ROOT}"`);

function priorityLabel(p) {
  if (!p) return "";
  const val = String(p).toLowerCase();
  if (val.startsWith("h")) return "High";
  if (val.startsWith("m")) return "Med";
  if (val.startsWith("l")) return "Low";
  return "";
}

// helper to calculate day difference
function daysBetween(older, newer) {
  const diff = Math.floor((newer.ts - older.ts) / (1000 * 60 * 60 * 24));
  return diff;
}

let listItems = [];

// Tasks with due before host date (overdue)
for (const p of pages) {
  const tasks = p.file?.tasks ?? [];
  for (const t of tasks) {
    const d = t.due ? t.due.toISODate() : null;
    if (!t.completed && d && d < todayISO) {
      const dueDate = dv.date(d);
      const diff = daysBetween(dueDate, today);
      const line = dv.el("div", "", { cls: "dv-overdue-task" });

      // checkbox + text
      const container = line.createSpan();
      container.appendChild(dv.taskList([t], false));

      // days due display
      const text = diff === 1 ? "1 day due" : `${diff} days due`;
      line.createSpan({ text: "  ·  " + text });

      listItems.push(line);
    }
  }
}

// Notes with frontmatter due before host date
for (const p of pages) {
  const fm = p.file?.frontmatter ?? {};
  const fmDueISO = fm.due ? dv.date(fm.due).toISODate() : null;
  const isDone = fm.done === true || fm.completed === true;
  if (fmDueISO && fmDueISO < todayISO && !isDone) {
    const dueDate = dv.date(fmDueISO);
    const diff = daysBetween(dueDate, today);
    const line = dv.el("div", "", { cls: "dv-overdue-note" });

    // checkbox
    const cb = line.createEl("input", { type: "checkbox" });
    cb.addEventListener("change", async e => {
      await toggleFrontmatterDone(p.file.path, e.target.checked);
      app.workspace.trigger("dataview:refresh-views");
    });

    line.createSpan({ text: " " });
    const a = line.createEl("a", { href: "#", text: p.file.name });
    a.addEventListener("click", evt => {
      evt.preventDefault();
      app.workspace.openLinkText(p.file.path, dv.current().file.path, false);
    });

    // days due display
    const text = diff === 1 ? "1 day due" : `${diff} days due`;
    line.createSpan({ text: "  ·  " + text });

    listItems.push(line);
  }
}

// toggle YAML done (unchanged)
async function toggleFrontmatterDone(filePath, value) {
  const file = app.vault.getAbstractFileByPath(filePath);
  if (!file) return;
  const content = await app.vault.read(file);
  const m = content.match(/^---\n([\s\S]*?)\n---\n?([\s\S]*)$/);
  if (m) {
    let fm = m[1];
    if (/^done:/m.test(fm)) {
      fm = fm.replace(/^done:\s*(true|false).*$/m, `done: ${value}`);
    } else if (/^completed:/m.test(fm)) {
      fm = fm.replace(/^completed:\s*(true|false).*$/m, `completed: ${value}`);
    } else {
      fm += `\ndone: ${value}`;
    }
    await app.vault.modify(file, `---\n${fm}\n---\n${m[2]}`);
  } else {
    await app.vault.modify(file, `---\ndone: ${value}\n---\n${content}`);
  }
}

if (!listItems.length) {
  dv.paragraph("✅ All done! 👏");
} else {
  for (const item of listItems) dv.container.appendChild(item);
}
~~~
___
#### 👨‍💻My Daily Timeslots (6hrs)
*Type your tasks in these timeslots to plan your day.*
##### 🌅Morning (3.5hrs, 9.00-11.30AM)
*High-impact task*
- 
- 
'
##### ☀️Afternoon (1.5hrs, 2.00-3.30PM)
*Key delivery/admin task*
'
'
'
##### 🌙Night (1hr, 9.00-10.00PM)
*Habit / reflection*
'
'
'

---
#### 🔄 End-of-Day Review
How did the day go?
What worked and what didn’t?
What will you do differently tomorrow?
'
'
'
'
---

### 📫Inbox:
(Remove suffix ! from file name to release)
~~~dataview
TABLE
  dateformat(file.ctime, "yyyy-MM-dd") AS Created,
  gap + " " + choice(gap = 1, "day", "days") AS Age
FROM "03 SaveBox/Active"
WHERE endswith(file.name, "!")
FLATTEN floor((
  date(dateformat(date(now), "yyyy-MM-dd"))
  - date(dateformat(file.ctime, "yyyy-MM-dd"))
).milliseconds / 86400000) AS gap
SORT file.ctime ASC

~~~
### 🔗Backlinks:
~~~dataviewjs
const backlinks = dv.pages()
  .where(p =>
    p.file.outlinks &&
    p.file.outlinks.some(link => link.path === dv.current().file.path) &&
    !/template/i.test(p.file.folder) &&
    !/archive/i.test(p.file.folder)
  )
  .sort(p => p.file.name, 'asc');

if (backlinks.length) {
  dv.list(backlinks.map(p => p.file.link));
} else {
  dv.paragraph("None");
}
~~~

```templater


```


